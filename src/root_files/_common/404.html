<!DOCTYPE html>
<html>
<head>
    <title>Deriv</title>
    <meta charset="utf-8" />
    <meta name='referrer' content='origin' />
    <script type="text/javascript">
    function getCookieItem(sKey) {
        'use strict';
        return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || null;
    }

    var langs = {
        // TODO: uncomment if we enable id, ko and pt languages
        // 'id': 'id',
        // 'ko': 'kr',
        // 'pt': 'br|mz|ao|pt|gw|pg|cv|st',
        'de': 'de|at|li',
        'es': 'ar|bo|cl|co|cr|cu|do|ec|sv|gt|hn|mx|ni|pa|py|pr|es|uy|ve',
        'fr': 'fr|ad|bj|bf|cf|cg|ga|gn|ml|mc|ne|sn|tg',
        'it': 'it',
        'pl': 'po',
        'ru': 'ru|ua|by|kz',
        'th': 'th',
        'vi': 'vn',
        'zh_tw': 'tw|mo',
        'zh_cn': 'cn',
    };
    function getLanguage(country) {
        var conLang = 'en';
        if (country) {
            var keys = Object.keys(langs);
            for (var i = keys.length; i--; ) {
                var l = keys[i];
                if ((new RegExp(langs[l], 'i')).test(country)) {
                    return l;
                }
            }
        }
        return conLang;
    }

    function redirect(lang) {
        var base = /^(.+?).github.io$/.test(window.location.hostname) ? window.location.origin + '/binary-static' : window.location.origin;

        // redirect to /en/ page if pathname contains an unsupported language:
        const supported_langs_regex = Object.keys(langs).join('|');
        if (new RegExp(`^/(?!${supported_langs_regex})\\w{2,5}/\\w+`).test(window.location.pathname.toLowerCase())) {
            lang = 'en';
            window.location.href = base + '/' + lang + '/' + 'trading.html';
            return;
        }

        window.location.href = base + '/' + lang.toLowerCase() + '/' + '404.html';
    }

    function openWSAndGetLanguage(cb) {
        // Use default language fallback
        var lang = 'EN'; // Default to English
        return cb(lang);
    }

    var lang = getCookieItem('language');
    if (lang) {
        redirect(lang);
    } else {
        openWSAndGetLanguage(function(lang) {
            if (lang) redirect(lang);
        });
    }
    function getTopLevelDomain() {
        const current_domain = window.location.hostname;
        return (current_domain && current_domain.indexOf('.') >= 0) ? current_domain.split('.').splice(-1) : 'com';
    };
    
    function onLoad() {
        var btn__home = document.getElementById('btn__home');
        var home_url = `https://smarttrader.deriv.${getTopLevelDomain()}`;
        btn__home.href = home_url;
        btn__home.innerHTML = home_url;
    }
    document.addEventListener('DOMContentLoaded', function() {
        onLoad();
    }, false);
    </script>
</head>
<body>
    <h1>404</h1>
    <p style='font-size: 1.5em;'><a id='btn__home'></a></p>
</body>
</html>
